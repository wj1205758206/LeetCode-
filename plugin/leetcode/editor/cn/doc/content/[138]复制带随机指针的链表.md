<p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º <code>n</code> çš„é“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªé¢å¤–å¢åŠ çš„éšæœºæŒ‡é’ˆ <code>random</code> ï¼Œè¯¥æŒ‡é’ˆå¯ä»¥æŒ‡å‘é“¾è¡¨ä¸­çš„ä»»ä½•èŠ‚ç‚¹æˆ–ç©ºèŠ‚ç‚¹ã€‚</p>

<p>æ„é€ è¿™ä¸ªé“¾è¡¨çš„&nbsp;<strong><a href="https://baike.baidu.com/item/æ·±æ‹·è´/22785317?fr=aladdin" target="_blank">æ·±æ‹·è´</a></strong>ã€‚&nbsp;æ·±æ‹·è´åº”è¯¥æ­£å¥½ç”± <code>n</code> ä¸ª <strong>å…¨æ–°</strong> èŠ‚ç‚¹ç»„æˆï¼Œå…¶ä¸­æ¯ä¸ªæ–°èŠ‚ç‚¹çš„å€¼éƒ½è®¾ä¸ºå…¶å¯¹åº”çš„åŸèŠ‚ç‚¹çš„å€¼ã€‚æ–°èŠ‚ç‚¹çš„ <code>next</code> æŒ‡é’ˆå’Œ <code>random</code> æŒ‡é’ˆä¹Ÿéƒ½åº”æŒ‡å‘å¤åˆ¶é“¾è¡¨ä¸­çš„æ–°èŠ‚ç‚¹ï¼Œå¹¶ä½¿åŸé“¾è¡¨å’Œå¤åˆ¶é“¾è¡¨ä¸­çš„è¿™äº›æŒ‡é’ˆèƒ½å¤Ÿè¡¨ç¤ºç›¸åŒçš„é“¾è¡¨çŠ¶æ€ã€‚<strong>å¤åˆ¶é“¾è¡¨ä¸­çš„æŒ‡é’ˆéƒ½ä¸åº”æŒ‡å‘åŸé“¾è¡¨ä¸­çš„èŠ‚ç‚¹ </strong>ã€‚</p>

<p>ä¾‹å¦‚ï¼Œå¦‚æœåŸé“¾è¡¨ä¸­æœ‰ <code>X</code> å’Œ <code>Y</code> ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­ <code>X.random --&gt; Y</code> ã€‚é‚£ä¹ˆåœ¨å¤åˆ¶é“¾è¡¨ä¸­å¯¹åº”çš„ä¸¤ä¸ªèŠ‚ç‚¹ <code>x</code> å’Œ <code>y</code> ï¼ŒåŒæ ·æœ‰ <code>x.random --&gt; y</code> ã€‚</p>

<p>è¿”å›å¤åˆ¶é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</p>

<p>ç”¨ä¸€ä¸ªç”±&nbsp;<code>n</code>&nbsp;ä¸ªèŠ‚ç‚¹ç»„æˆçš„é“¾è¡¨æ¥è¡¨ç¤ºè¾“å…¥/è¾“å‡ºä¸­çš„é“¾è¡¨ã€‚æ¯ä¸ªèŠ‚ç‚¹ç”¨ä¸€ä¸ª&nbsp;<code>[val, random_index]</code>&nbsp;è¡¨ç¤ºï¼š</p>

<ul>
	<li><code>val</code>ï¼šä¸€ä¸ªè¡¨ç¤º&nbsp;<code>Node.val</code>&nbsp;çš„æ•´æ•°ã€‚</li>
	<li><code>random_index</code>ï¼šéšæœºæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ç´¢å¼•ï¼ˆèŒƒå›´ä»&nbsp;<code>0</code>&nbsp;åˆ°&nbsp;<code>n-1</code>ï¼‰ï¼›å¦‚æœä¸æŒ‡å‘ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™ä¸º&nbsp;&nbsp;<code>null</code>&nbsp;ã€‚</li>
</ul>

<p>ä½ çš„ä»£ç  <strong>åª</strong> æ¥å—åŸé“¾è¡¨çš„å¤´èŠ‚ç‚¹ <code>head</code> ä½œä¸ºä¼ å…¥å‚æ•°ã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e1.png" style="height: 142px; width: 700px;" /></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>head = [[7,null],[13,0],[11,4],[10,2],[1,0]]
<strong>è¾“å‡ºï¼š</strong>[[7,null],[13,0],[11,4],[10,2],[1,0]]
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e2.png" style="height: 114px; width: 700px;" /></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>head = [[1,1],[2,1]]
<strong>è¾“å‡ºï¼š</strong>[[1,1],[2,1]]
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<p><strong><img alt="" src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e3.png" style="height: 122px; width: 700px;" /></strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>head = [[3,null],[3,0],[3,null]]
<strong>è¾“å‡ºï¼š</strong>[[3,null],[3,0],[3,null]]
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
	<li><code>0 &lt;= n &lt;= 1000</code><meta charset="UTF-8" /></li>
	<li><code>-10<sup>4</sup>&nbsp;&lt;= Node.val &lt;= 10<sup>4</sup></code></li>
	<li><code>Node.random</code>&nbsp;ä¸º&nbsp;<code>null</code> æˆ–æŒ‡å‘é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€‚</li>
</ul>
<details><summary><strong>Related Topics</strong></summary>å“ˆå¸Œè¡¨ | é“¾è¡¨</details><br>

<div>ğŸ‘ 931, ğŸ‘ 0</div>

<div id="labuladong"><hr>

**é€šçŸ¥ï¼š[æ•°æ®ç»“æ„ç²¾å“è¯¾ V1.8](https://aep.h5.xeknow.com/s/1XJHEO) æŒç»­æ›´æ–°ä¸­ã€‚**

<details><summary><strong>labuladong æ€è·¯</strong></summary>

## åŸºæœ¬æ€è·¯

ä½ å¯ä»¥è®¤ä¸ºè¿™é“é¢˜å’Œ [133. å…‹éš†å›¾](/problems/clone-graph) æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œå› ä¸ºé“¾è¡¨åŠ ä¸€ä¸ªéšæœºæŒ‡é’ˆæœ¬è´¨ä¸Šå°±å˜æˆäº†ä¸€å¹…å›¾ã€‚

å»ºè®®ä½ å»çœ‹ä¸‹æˆ‘åœ¨ 133 é¢˜å†™çš„æ€è·¯ï¼Œæˆ‘ç›´æ¥æŠŠ 133 é¢˜çš„è§£æ³•ä»£ç ç¨ä½œä¿®æ”¹å¤åˆ¶è¿‡æ¥å³å¯è§£å†³è¿™é“é¢˜ã€‚

**æ ‡ç­¾ï¼š[é“¾è¡¨](https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzAxODQxMDM0Mw==&action=getalbum&album_id=2120596033251475465)**

## è§£æ³•ä»£ç 

```java
class Solution {
    public Node copyRandomList(Node head) {
        traverse(head);
        return originToClone.get(head);
    }

    // è®°å½• DFS éå†è¿‡çš„èŠ‚ç‚¹ï¼Œé˜²æ­¢èµ°å›å¤´è·¯
    HashSet<Node> visited = new HashSet<>();
    // è®°å½•åŸèŠ‚ç‚¹åˆ°å…‹éš†èŠ‚ç‚¹çš„æ˜ å°„
    HashMap<Node, Node> originToClone = new HashMap<>();

    // DFS å›¾éå†æ¡†æ¶
    void traverse(Node node) {
        if (node == null) {
            return;
        }
        if (visited.contains(node)) {
            return;
        }
        // å‰åºä½ç½®ï¼Œæ ‡è®°ä¸ºå·²è®¿é—®
        visited.add(node);
        // å‰åºä½ç½®ï¼Œå…‹éš†èŠ‚ç‚¹
        if (!originToClone.containsKey(node)) {
            originToClone.put(node, new Node(node.val));
        }
        Node cloneNode = originToClone.get(node);

        // é€’å½’éå†é‚»å±…èŠ‚ç‚¹ï¼Œå¹¶æ„å»ºå…‹éš†å›¾
        // é€’å½’ä¹‹åï¼Œé‚»å±…èŠ‚ç‚¹ä¸€å®šå­˜åœ¨ originToClone ä¸­

        traverse(node.next);
        cloneNode.next = originToClone.get(node.next);

        traverse(node.random);
        cloneNode.random = originToClone.get(node.random);
    }
}
```

</details>
</div>





